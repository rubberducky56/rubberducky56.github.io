---
layout: post
title: "Malware Analysis At A Glance"
author: "Mouse"
categories: cybersecurity
tags: [cybersecurity, programming, malware, reverse-engineering]
image: malware_analysis.png
permalink: /cybersecurity/malware-analysis-at-a-glance
---

### What is Malware?

_Malware_, or malicious software, is software designed to cause harm to a system or network. It is common for malware to have mechanisms built in to spread itself throughout a system, remain undetectable, damage data, and render a computer unusable.

One famous example of malware is _Stuxnet_. In January 2010, a routine inspection of the Natanz Uranium Enrichment Plant in Iran was carried out by the International Atomic Energy Agency. They found that many centrifuges were failing, but no cause was specified. Later in 2010, a number of computer systems in the plant were crashing and rebooting. When technicians analysed the computer for _IoCs_, or _indicators of compromise_, they found numerous malicious files installed. Those technicians had just discovered one of the most infamous pieces of malware ever cooked up - Stuxnet.

Stuxnet spread itself through Windows PCs and USB sticks until it found its way into the Natanz plant. When critical _SCADA_ (Supervisory Control and Data Acquisition) systems, such as nuclear gas centrifuges, were infected, the malware caused them to malfunction. The Natanz centrifuges would essentially tear themselves apart.

Stuxnet was an extremely sophisticated, targeted attack which severely crippled Iran’s nuclear weapons program. It is speculated that Stuxnet was built as a cyber weapon as a collaboration between US and Israeli intelligence agencies, but neither have since claimed responsibility. Stuxnet was the first demonstration of malware being used to cause significant physical damage, and bring a country’s nuclear program to its knees.

This article is an introduction to malware, and will discuss some basic malware analysis techniques. Malware analysis is a huge area, so I will only be scratching the surface. This article is loosely based off the [TryHackMe malware module](https://tryhackme.com/module/malware-analysis).

### Types of Malware

Malware campaigns generally come in two flavours:
1. Targeted campaigns - created for a specific purpose for a specific target
>The Stuxnet malware campaign was targeted - it was targeting Iranian nuclear facilities

2. Mass campaigns - the aim is to infect as many devices as possible, and are usually run by _APT_ groups, or _Advanced Persistent Threat_ groups.
>In April 2022, Bitdefender detailed a mass malware campaign using _RedLine Stealer_ - a data harvesting piece of malware that can steal passwords, usernames and credit card data on Windows PCs. RedLine Stealer is often sold on underground forums as _malware-as-a-service_. This is when novices can buy malware off the shelf and execute their own malware campaigns. Bitdefender’s whitepaper can be downloaded from [here]https://www.bitdefender.com/blog/labs/redline-stealer-resurfaces-in-fresh-rig-exploit-kit-campaign/.

Malware can come in all shapes and sizes, and some common malware types are listed below. Note that some definitions have no consensus - I will be using the definitions coined by Fortinet.

* _Viruses_ - malware which can propagate through a system, but requires human intervention
  * _File viruses_ - These infect files on a system, often executables, and can infect other files when opened
  * _Macro viruses_ - Microsoft Office products allow users to write small programs to automate repetitive tasks, called macros. Macro viruses infect Microsoft Office files, and propagate once the file is opened
  * _Polymorphic viruses_ - Viruses that can change their form to evade detection
* _Trojans_ - Malware that hides in legitimate files, named after the famous Trojan Horse from Greek mythology
* _Worms_ - Malware that is similar to viruses, but does not require human intervention to propagate - they spread themselves through a system
* _Spam_ - Malware that is stored inside email attachments or links, usually tricking a user to click a link or download a program
* _Ransomware_ - Malware that encrypts data on a system, and kindly requests users to pay a ransom to get their data back, usually in the form of cryptocurrencies.
* _Rootkits_ - Malware that functions as a Swiss army knife - they embed themselves deep into a system, often onto the kernel itself, and allow threat actors complete control over a system
* _Adware_ - One of the most common types of malware infection, these will cause unwanted advertisements to pop up all over a computer system
* _Spyware_ - Malware that quietly infects a system and sends personal data back to threat actors. This category includes keyloggers, which record all keystrokes typed by a user and sends these back to the threat actor.
